<!DOCTYPE html>
<html>

<body>
  <p>fdfd</p>
  <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
  <script>
    Office.onReady(info => {
      if (info.host === Office.HostType.Outlook) {
        autoInsertSignature();
      }
    });

    async function autoInsertSignature() {
      const email = Office.context.mailbox.userProfile.emailAddress;
      console.log("Email:", email);
      try {
        const res = await fetch(`http://localhost:5000/api/signature/get?email=${email}`);
        const { signatureHTML } = await res.json();

        Office.context.mailbox.item.body.setAsync(signatureHTML, { coercionType: "html" }, (asyncResult) => {
          if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {
            console.log("Signature inserted!");
          } else {
            console.error(asyncResult.error);
          }
        });

      } catch (err) {
        console.error("Error inserting signature", err);
      }
    }
  </script>
</body>

</html>